<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/stadium.css">
    <link rel="stylesheet" href="/css/base.css">
    <title>Hust Sport</title>
</head>

<body onload="start()">
    <header>
        <div class="header-left">
            <a href="/index.html"><img src="/assets/img/logo/logo-full.png" alt=""></a>
        </div>

        <div class="header-right">
            <ul class="menu">
                <li><a href="/index.html">TRANG CHỦ</a></li>
                <li class="menu-product">
                    <a href="#product">
                        SẢN PHẨM
                        <i class="fa-solid fa-chevron-down"></i>
                    </a>

                    <div class="sub-menu-product">
                        <div onclick="redirectToCategory('Bóng đá', '2c6933bc-96ac-47c8-921f-e275018b31e9')">Bóng đá
                        </div>
                        <div onclick="redirectToCategory('Bóng chuyền','42380a8f-4330-4b72-be77-df613b206bb8')">Bóng
                            chuyền</div>
                        <div onclick="redirectToCategory('Bơi lội','9adf2fdf-4dc8-4fec-85f5-42455815761b')">Bơi lội
                        </div>
                        <div onclick="redirectToCategory('Chạy bộ','fb441d06-8e04-4780-8659-a87258048a82')">Chạy bộ
                        </div>

                    </div>

                </li>
                <li><a href="#footer">LIÊN HỆ</a></li>

                <li class="header_cart">
                    <span class="header_cart-navItem">GIỎ HÀNG</span>
                    <div class="header_cart-body">
                        <h4 class="header_cart-list-title">Sản phẩm đã thêm</h4>
                        <img src="/assets/img/others/no-cart.png" alt="" class="header_cart-no-cart-img">
                        <span class="header_cart-list-no-cart-msg">
                            Chưa có sản phẩm
                        </span>
                        <ul id="header-cart-list"> </ul>
                        <div class="go-to-cart-btn" onclick="moveToCart()">
                            <button>Đi đến giỏ hàng</button>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="heading-btn">
                <button class="btn-login">Đăng nhập</button>
            </div>
            <div class="header-user">
                <p class="header-fullname">Username</p>
                <img src="" class="header-user-avatar">
                <i class="fa-solid fa-chevron-down" id="user-action"></i>
                <div class="user-menu">
                    <span class="user-profile" onclick="showProfilePage()">Xem tài khoản</span>
                    <span class="user-logout" onclick="logOut()">Đăng xuất</span>
                </div>
            </div>
        </div>
    </header>

    <section id="stadium">
        <div class="stadium-top">
            <h1>DANH SÁCH SÂN BÓNG: </h1>
            <div class="search-input">
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                    <path
                        d="M16.5769 8.03846C16.5769 12.478 12.978 16.0769 8.53846 16.0769C4.09894 16.0769 0.5 12.478 0.5 8.03846C0.5 3.59894 4.09894 0 8.53846 0C12.978 0 16.5769 3.59894 16.5769 8.03846ZM1.59915 8.03846C1.59915 11.8709 4.70598 14.9778 8.53846 14.9778C12.3709 14.9778 15.4778 11.8709 15.4778 8.03846C15.4778 4.20598 12.3709 1.09915 8.53846 1.09915C4.70598 1.09915 1.59915 4.20598 1.59915 8.03846Z"
                        fill="#929090" />
                    <line x1="13.63" y1="13.1775" x2="20.2069" y2="19.7544" stroke="#929090" stroke-width="2" />
                </svg>
                <input id="searchInput" type="text" placeholder="Tìm kiếm sân bóng..." onkeydown="searchStadium(event)">
            </div>
        </div>

        <div class="container">
            <ul class="stadium-list">
                <!-- <li class="stadium-item">
                    <a href="">
                        <img class="stadium-main-img" src="/assets/img/product/product-category.png" alt="">
                        <h2>Sân bóng đầm hồng 2</h2>
                        <div class="stadium-item-info">
                            <p>Số người: 5 - 7</p>
                            <div class="stadium-price">100.000đ</div>
                        </div>
                    </a>
                </li> -->


            </ul>

            <ul class="stadium-list-page">
                <!-- <li class="stadium-prev-page"><i class="fa-solid fa-angle-left"></i></li>
                <li class="page">1</li>
                <li class="page">2</li>
                <li class="stadium-next-page"><i class="fa-solid fa-angle-right"></i></li> -->
            </ul>


        </div>

    </section>



    <footer id="footer">
        <div class="footer-product">
            <h3>Sản phẩm</h3>
            <ul class="">
                <li><a href="">Quần áo</a></li>
                <li><a href="">Giày</a></li>
                <li><a href="">Bóng</a></li>
                <li><a href="">Kính bơi</a></li>
                <li><a href="">Phụ kiện</a></li>
            </ul>

        </div>
        <div class="footer-sport">
            <h3>Thể thao</h3>
            <ul>
                <li><a href="/category.html">Bóng đá</a></li>
                <li><a href="">Bóng chuyền</a></li>
                <li><a href="">Bơi lội</a></li>
                <li><a href="">Chạy</a></li>
            </ul>
        </div>
        <div class="footer-info">
            <h3>Thông tin</h3>
            <ul>
                <li>Web bán hàng và dịch vụ thể thao</li>
                <li>Nhóm 6 - lớp 144913</li>
                <li>Nhập môn Công nghệ Phần mềm</li>
                <li>GVHD: cô Bùi Thị Mai Anh</li>
            </ul>
        </div>
        <div class="footer-members">
            <h3>Thành viên</h3>
            <ul>
                <li>Đỗ Đức Long 20215609</li>
                <li>Nguyễn Thanh Hải 20215571</li>
                <li>Trần Ngọc Minh 20215617</li>
                <li>Vũ Quang Nam 20215622</li>
                <li>Đào Anh Quân 20215631</li>
                <li>Vũ Văn Hùng 20215588</li>
            </ul>
        </div>
        <div class="footer-follow-us">
            <h3>Theo dõi chúng tôi</h3>
            <ul>
                <li><a href="https://www.facebook.com/" target="_blank"><img src="/assets/img/icon/fb.png" alt=""></a>
                </li>
                <li><a href="https://www.youtube.com/" target="_blank"><img src="/assets/img/icon/insta.png" alt=""></a>
                </li>
                <li><a href="https://www.instagram.com/" target="_blank"><img src="/assets/img/icon/youtube.png"
                            alt=""></a></li>
                <li><a href="https://twitter.com/?lang=vi" target="_blank"><img src="/assets/img/icon/twitter.png"
                            alt=""></a></li>
                <li><a href="https://www.tiktok.com/vi-VN/" target="_blank"><img src="/assets/img/icon/tiktok.png"
                            alt=""></a>
                </li>
            </ul>
        </div>
    </footer>
</body>


<script src="/js/base.js"></script>
<script>
    function start() {
        getAllStadium();
        loadStadiumItem();
        changeHeader();
        updateCart();
        showShoppingCartMenu();
    }

    // product list - pagination
    let thisPage = 1;
    let limit = 8;

    function loadStadiumItem() {
        let stadiumList = document.querySelectorAll('.stadium-item');
        let beginGet = limit * (thisPage - 1);
        let endGet = limit * thisPage - 1;
        stadiumList.forEach((item, key) => {
            if (key >= beginGet && key <= endGet) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        })
        listPage();
    }

    function listPage() {
        let stadiumList = document.querySelectorAll('.stadium-item');

        let count = Math.ceil(stadiumList.length / limit);
        document.querySelector('.stadium-list-page').innerHTML = '';
        for (i = 1; i <= count; i++) {
            let newPage = document.createElement('li');
            newPage.classList.add('page');
            newPage.innerText = i;
            if (i === thisPage) {
                newPage.classList.add('current-stadium-page');
            } else {
                newPage.style.backgroundColor = '#cecece';
            }
            newPage.setAttribute('onclick', "changePage(" + i + ")");
            document.querySelector('.stadium-list-page').appendChild(newPage);
        }
    }

    function changePage(i) {
        thisPage = i;
        loadStadiumItem();
    }



    function getAllStadium() {
        let stadiumList = document.querySelector('.stadium-list');
        fetch('https://api-hust.eztek.net/stadium/get-all-stadium?Page=0&PageSize=100', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${idToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                data.data.forEach(stadium => {
                    stadiumList.innerHTML +=
                        `
                         <li class="stadium-item" data-stadium-id=${stadium.id}>
                            <a href="stadium-details.html?id=${stadium.id}">
                                <img class="stadium-main-img" src="${stadium.image}" alt="">
                                <h2>${stadium.name}</h2>
                                <div class="stadium-item-info">
                                    <p>Số người: 5 - 7</p>
                                    <div class="stadium-price">${stadium.price.toLocaleString('vn-VN') + 'đ'}</div>
                                </div>
                            </a>
                        </li> 
                            
                        `

                })
            })
            .catch(err => {
                console.log(err);
            })
    }


    // Lấy ra keyword tìm kiếm và hiển thị danh sách kết quả
    // document.addEventListener("DOMContentLoaded", function () {
    //     // Lấy tham số từ URL
    //     var urlParams = new URLSearchParams(window.location.search);
    //     var keyword = urlParams.get('keyword');

    //     if (keyword) {
    //         // Gọi hàm để lấy và hiển thị sản phẩm từ API
    //         fetchSearchProduct(keyword);
    //     }
    // });

    function fetchSearchStadium(keyword) {
        let title = document.querySelector('.stadium-top h1');
        let stadiumList = document.querySelector('.stadium-list');

        fetch(` https://api-hust.eztek.net/stadium/search-stadium?KeyWord=${encodeURIComponent(keyword)}&Page=0&PageSize=100`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${idToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                title.textContent = `KẾT QUẢ TÌM KIẾM: "${keyword}"`;
                stadiumList.innerHTML = '';

                if (data.data.length === 0) {
                    stadiumList.innerHTML += `     <div class="no-stadium-find">
                    <h2>Không tìm thấy sân !</h2>
                    <img src="/assets/img/others/No_Product_Found.png" alt="">
                </div>`;

                    stadiumList.querySelector('.no-stadium-find').style.display = 'flex';
                    stadiumList.style.display = 'block';
                } else {

                    data.data.forEach(stadium => {
                        stadiumList.innerHTML +=
                            `
                             <li class="stadium-item" data-stadium-id=${stadium.id}>
                                <a href="stadium-details.html?id=${stadium.id}">
                                    <img class="stadium-main-img" src="${stadium.image}" alt="">
                                    <h2>${stadium.name}</h2>
                                    <div class="stadium-item-info">
                                        <p>Số người: 5 - 7</p>
                                        <div class="stadium-price">${stadium.price.toLocaleString('vn-VN') + 'đ'}</div>
                                    </div>
                                </a>
                            </li> 
                                
                            `

                    })

                }



            })
            .catch(err => {
                console.log(err);
            })
    }


    function searchStadium(event) {
        if (event.keyCode === 13) {
            var keyword = searchInput.value.trim();

            if (keyword !== '') {
                fetchSearchStadium(keyword);
            }
        }
    }
</script>

</html>